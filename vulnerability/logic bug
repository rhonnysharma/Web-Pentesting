 Business Logic Issues
 
1. Review Functionality
- Some applications have an option where verified reviews are marked with some tick or it's mentioned. Try to see if you can post a review as a Verified Reviewer without purchasing that product.
- Some app provides you with an option to provide a rating on a scale of 1 to 5, try to go beyond/below the scale-like provide 0 or 6 or -ve.
- Try to see if the same user can post multiple ratings for a product. This is an interesting endpoint to check for Race Conditions.
- Try to see if the file upload field is allowing any exts, it's often observed that the devs miss out on implementing protections on such endpoints. 
- Try to post reviews like some other users.
- Try performing CSRF on this functionality, often is not protected by tokens

2. Coupon Code Functionality 
- Apply the same code more than once to see if the coupon code is reusable. 
- If the coupon code is uniquely usable, try testing for Race Condition on this function by using the same code for two accounts at a parallel time.
- Try Mass Assignment or HTTP Parameter Pollution to see if you can add multiple coupon codes while the application only accepts one code from the Client Side. 
- Try performing attacks that are caused by missing input sanitization such as XSS, SQLi, etc. on this field
- Try adding discount codes on the products which are not covered under discounted items by tampering with the request on the server-side. 

3. Delivery Charges Abuse 
- Try tampering with the delivery charge rates to -ve values to see if the final amount can be reduced.
- Try checking for the free delivery by tampering with the params.

4. Currency Arbitrage 
- Pay in 1 currency say USD and try to get a refund in EUR. Due to the diff in conversion rates, it might be possible to gain more amount.
(cont'd...) 
5. Premium Feature Abuse 
- Try forcefully browsing the areas or some particular endpoints which come under premium accounts.
- Pay for a premium feature and cancel your subscription. If you get a refund but the feature is still usable, it's a monetary impact issue.
- Some applications use true-false request/response values to validate if a user is having access to premium features or not.
- Try using Burp's Match & Replace to see if you can replace these values whenever you browse the app & access the premium features.
- Always check cookies or local storage to see if any variable is checking if the user should have access to premium features or not.

6. Refund Feature Abuse
- Purchase a product (usually some subscription) and ask for a refund to see if the feature is still accessible.
- Try for currency arbitrage explained yesterday.

7. No Limit on Email Subscription ->  Business Logic Error which cause unlimited amount of Newsletter Subscription 
- Open Burpsuite and set the proxy and intercept on.
- Then Go to  and enter the Email you want to Bomb and press subscribe... (Make sure Burp Intercept is ON)
- .Then press enter and you burp has captured a request looks like this

POST /newsletter/subscriber/new/ HTTP/1.1
Host: demo.openmage.org
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 28
Origin: https://demo.openmage.org
Connection: close
Referer: https://demo.openmage.org/
Upgrade-Insecure-Requests: 1
email=deyidi6330%401adir.com

- Now right click on request and click send to intruder.
- Now remove the cookies here i have already removed that and at Accept-Language Header Select the 5 and click on Add ยง Now 5 will look like this ยง5ยง and now in Payload tab select payload type Null Payloads and Select Generate Payloads set it to 50....
- And after that click on Start Attack
You will see you are getting unlimited amount of NewsLetter Subscription Emails
reference-> https://hackerone.com/thecyberjerry?type=user

Prevention
I suggest you enable CAPTCHA on frontend and admin for every feature to help prevent these kinds of reports. 
Although in this case there is no Captcha for newsletter subscription.. 
But you can enable requiring email confirmation. Please go through config and enable every paranoid option you can find. :)
Impact 
An Attacker Can Send Bulk Emails and Many Emails and in Emails He can inject Infected XSS which can captures USER SESSION TOKEN

Sure,Just having an Idea about If an attacker can manipulate the flow of Email Subscription he also can inject XSS or any other infected code which can hijack User Session.Don't Worry Just having a guess about XSS because i m working on it and scanning about any XSS bug. :)
When this BUG will be fixed that will automatically be fixed...
Cheers : )
- Try making multiple requests for subscription cancellation (race conditions) to see if you can get multiple refunds.

7. Cart/Wishlist Abuse 
- Add a product in negative quantity with other products in positive quantity to balance the amount.
- Add a product in more than the available quantity.
- Try to see when you add a product to your wishlist and move it to a cart if it is possible to move it to some other user's cart or delete it from there.

8. Thread Comment Functionality
- Unlimited Comments on a thread
- Suppose a user can comment only once, try race conditions here to see if multiple comments are possible.
- Suppose there is an option: comment by the verified user (or some privileged user) try to tamper with various parameters in order to see if you can do this activity.
- Try posting comments impersonating some other users.
(Cont'd...)
9. Parameter Tampering 
- Tamper Payment or Critical Fields to manipulate their values
- Add multiple fields or unexpected fields by abusing HTTP Parameter Pollution & Mass Assignment
- Response Manipulation to bypass certain restrictions such as 2FA Bypass 

10. App Implementation Logic Abuse
- If an app accepts JSON data, try changing content type to XML and see if the XML data is being processed, it can be left vulnerable to XXE or XML-based attacks.
- If an application is using the DELETE method to delete a resource but there is no CSRF protection, try converting the method to GET/POST and add an additional parameter like ?method=delete
- In the above case if any user ID is going in the request, try bypassing method-based restrictions by adding parameters like X-Method-Override.
- If you see a UUID, try to replace with similar mapping such as 1,2,3.. often UUID mapping is accepted by the applications.
- Try the HEAD method to bypass the authentication restrictions. 

11. Denial of Service Situations 
- Resource Exhaustion
- Weak Account Lockout Mechanisms
- Kicking out a user/banning a user somehow from accessing the application.
- Application Level DoS by abusing the various functionalities present within the application.

In a nutshell, business logic absuse is a special class of vulnerabilities that I personally feel has no end.
Every application might have some different or special logics which are unique to them and it's always fun to abuse them and circumvent their original workflow.

12. Account takeover due to misconfiguration
-Its a very simple logical flaw that results in this
- So suppose we are victim@gmail.com , now login into the website then
- go to account settings and then change mail address to victim111@gmail.com
- a link will be sent to victim111@gmail.com, now the user realizes that he have lost access to victim111@gmail.com due to some reasons
- so he will probably change mail to the another mail address for e.g victim999@gmail.com which he owns and has access to
- but it is found that even after verifying victim999@gmail.com, the old link which was sent to victim111@gmail.com is active, 
 so user/attacker having access to that mail can verify it and takeover acc
 
 In a nutshell :
- It is mandatory for a web app to invalidate the tokens in time to secure its user
- In this case, suppose while changing mail address the user mistakenly typed wrong mail address, so the link will be sent to that mail address.
- So the user probably don't want the user of that mail address to verify it, so he will quickly change his mail address to one he owns and verify it-
- what he doesn't know is that even after verification(change of major state), the old link is still active
- the flaw :
- user changes mail to attacker@gmail.com -> user realizes that he mistyped the mail -> so he again changes to mail he owns and verifies it 
- -> old link sent to attacker@gmail.com is still active even after new mail has been verified
---------------------------------------------------------------------------------------
Logic Flaws :
Users have been provided with an option to invite friends as referrals. It is possible to abuse your email invite service by repeating the same request. 
It is a discredit to unikrn if someone repeatedly sends the referral mail to same account. A simple php script will do that work and also loss of server resources.
It is possible to invite myself from my referral link and even verify account and get coins.
Using same emails to produce multiple accounts on Unikrn:
The above flaw is more serious than self referring.
I can get verified account by using someone else's alias email (krishn.akrish759213@gmail.com ) which Unikrn thinks is unregistered. 
The user with email(krishna.krish759213@gmail.com ) gets a verification link. He thinks it is a normal verification of his own account and verifies by clicking on it.
-------------------------------------------------------------------------------------
Details:
During brief review of Liberapay application I have noticed that under 'Profile' page it's allowed to change username + name data. 
The first thing that caught my eye - "Name (optional) Maximum length is 64 <input name="public_name" class="form-control" value="zzzzz" maxlength="64" placeholder="Name">". 
It means that application has front-end user input validation, but what about back-end?
In case when the user exceeds the specified limit, the application server will return a response with the following status: 400 Bad Request + entire string that was inserted by user. Having this information in mind it was decided to check how the application server will handle the POST request that contains 100, 500, 10000, ... public_name value length.
In my case I simply changed the maxlength value directly at the DOM.

Remediation:
The recommendation here is simple, before sending an actual processing request - the application need to double check the content-length at back end. All user input input should be validated at back-end.

Impact
This surface is a good base for a planning a DDoS attack Liberapay with a small bot-net asset, i.e. small number of machines may cause a consuming of server's RAM.
--------------------------------------------------------------------------
Running 2 accounts with a single email

While testing, I found a logic flaw which made me to make two accounts with a single email
Reproduction Steps
1-Create one account with abc@gmail.com
2-another with abc+1@gmail.com or abc+2@gmail.com etc
3-Emails of both accounts will come at abc@gmail.com

fix:
Dont allow "+" in emails.
Thanks,
------------------------------------------------------------------------------
overwrite account associated with email

Hi,
It's possible to deny any user from logging in to his account by overwriting the password associated with his email. 
This is not an account takeover because while we do override the password associated with that specific mail we just login to a "new" account and not the user's original one.
Steps to reproduce:
1) Create first account via Vine for android with the mail firstaccountmail@gmail.com with the password Bla123
2) You can now see that you can login to the account created above.
3) Go and create another account - this time with a different password and with the mail Firstaccountmail@gmail.com - notice the CAPS (you can put the caps everywhere on the mail).
4) Finish the creation process - and see that it succeeds
5) Now go back and try to login with firstaccountmail@gmail.com and the password Bla123 and see that you can't. However, it's possible to login with firstaccountmail@gmail.com and the second password you have created - but you"ll login to the second created account.

It might be more severe than I first thought - since if the user requests to reset the password it resets the password for the newly created account - meaning he can never recover his old data, And since this issue doesn't require any user interaction this can mean an attacker can "erase" ALL of Vine's users very quickly.


Dec 4th (5 years ago)
Just another final note to help you investigate: it seems to work only if the first account didn't confirm his email.
--------------------------------------------------------------------------------
Summary:

HI team, i hope you are good :)
Its a very simple logical flaw that results in this
So suppose we are victim@gmail.com , now login into the website then
go to account settings and then change mail address to victim111@gmail.com
a link will be sent to victim111@gmail.com, now the user realizes that he have lost access to victim111@gmail.com due to some reasons
so he will probably change mail to the another mail address for e.g victim999@gmail.com which he owns and has access to
but it is found that even after verifying victim999@gmail.com, the old link which was sent to victim111@gmail.com is active, so user/attacker having access to that mail can verify it and takeover acc
In a nutshell :
It is mandatory for a web app to invalidate the tokens in time to secure its user
In this case, suppose while changing mail address the user mistakenly typed wrong mail address, so the link will be sent to that mail address.
So the user probably don't want the user of that mail address to verify it, so he will quickly change his mail address to one he owns and verify it
what he doesn't know is that even after verification(change of major state), the old link is still active
the flaw :
user changes mail to attacker@gmail.com -> user realizes that he mistyped the mail -> so he again changes to mail he owns and verifies it -> old link sent to attacker@gmail.com is still active even after new mail has been verified

Impact
An attacker can takeover acc due to misconfiguration, not invalidation of tokens at major state change, in time


https://hackerone.com/reports/1114347
----------------------------------------------------------------
Bypass Password Authentication to Update the Password

Steps To Reproduce:
With the assumption that the victim's twitter session is 'hijacked' and in a 'logged in' state for the hacker. The below steps must be followed In order to reproduce 
the security vulnerability.
Security Vulnerability #1 - Update Victim's Password - Bypass old password by unrestricted rate limiting
1.Go to Settings and Privacy -> Accounts
2.Click on Email -> Password
3.Enter any random password and Click on 'Next'
4.Intercept the request the above request and send it to intruder
5.Then select the position old password
6.Then go in payload add password list
7.Then start the attack bcoz of no rate limit the password bruteforcing is continue and find the correct password and update the old one
Resolution: Apply the Rate Limitation
Supporting Material/References:
Impact
This a serious security vulnerability, as It could lead to a hacker completely taking over the user's account by overriding twitter's 
security protocol as they could use this technique to bypass the password and it use to fully takeover the victim password

https://hackerone.com/reports/970157
-------------------------------------------------------------------------------
Full Account Takeover
---------------------------------------------------------------------------

It's a new technique about random account takeover,
scenario is:
1 - we registered in website.com and get a fixed cookie that maybe stored in DB and if you loged in again you will get same cookie
2 - now what if we signup in any other subdomain that belongs to the same company jp.website.com and has the same functionality of set cookie, 
now you can registered by any email in jp.website.com and you will get a cookie.
3 - try using this cookie in main domain website.com/profile and tell me what happened :)
--------------------------------------------------


