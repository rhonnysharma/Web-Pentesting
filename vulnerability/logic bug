 Business Logic Issues
 
1. Review Functionality
- Some applications have an option where verified reviews are marked with some tick or it's mentioned. Try to see if you can post a review as a Verified Reviewer without purchasing that product.
- Some app provides you with an option to provide a rating on a scale of 1 to 5, try to go beyond/below the scale-like provide 0 or 6 or -ve.
- Try to see if the same user can post multiple ratings for a product. This is an interesting endpoint to check for Race Conditions.
- Try to see if the file upload field is allowing any exts, it's often observed that the devs miss out on implementing protections on such endpoints. 
- Try to post reviews like some other users.
- Try performing CSRF on this functionality, often is not protected by tokens

2. Coupon Code Functionality 
- Apply the same code more than once to see if the coupon code is reusable. 
- If the coupon code is uniquely usable, try testing for Race Condition on this function by using the same code for two accounts at a parallel time.
- Try Mass Assignment or HTTP Parameter Pollution to see if you can add multiple coupon codes while the application only accepts one code from the Client Side. 
- Try performing attacks that are caused by missing input sanitization such as XSS, SQLi, etc. on this field
- Try adding discount codes on the products which are not covered under discounted items by tampering with the request on the server-side. 

3. Delivery Charges Abuse 
- Try tampering with the delivery charge rates to -ve values to see if the final amount can be reduced.
- Try checking for the free delivery by tampering with the params.

4. Currency Arbitrage 
- Pay in 1 currency say USD and try to get a refund in EUR. Due to the diff in conversion rates, it might be possible to gain more amount.
(cont'd...) 
5. Premium Feature Abuse 
- Try forcefully browsing the areas or some particular endpoints which come under premium accounts.
- Pay for a premium feature and cancel your subscription. If you get a refund but the feature is still usable, it's a monetary impact issue.
- Some applications use true-false request/response values to validate if a user is having access to premium features or not.
- Try using Burp's Match & Replace to see if you can replace these values whenever you browse the app & access the premium features.
- Always check cookies or local storage to see if any variable is checking if the user should have access to premium features or not.

6. Refund Feature Abuse
- Purchase a product (usually some subscription) and ask for a refund to see if the feature is still accessible.
- Try for currency arbitrage explained yesterday.

7. No Limit on Email Subscription ->  Business Logic Error which cause unlimited amount of Newsletter Subscription 
- Open Burpsuite and set the proxy and intercept on.
- Then Go to  and enter the Email you want to Bomb and press subscribe... (Make sure Burp Intercept is ON)
- .Then press enter and you burp has captured a request looks like this

POST /newsletter/subscriber/new/ HTTP/1.1
Host: demo.openmage.org
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 28
Origin: https://demo.openmage.org
Connection: close
Referer: https://demo.openmage.org/
Upgrade-Insecure-Requests: 1
email=deyidi6330%401adir.com

- Now right click on request and click send to intruder.
- Now remove the cookies here i have already removed that and at Accept-Language Header Select the 5 and click on Add ยง Now 5 will look like this ยง5ยง and now in Payload tab select payload type Null Payloads and Select Generate Payloads set it to 50....
- And after that click on Start Attack
You will see you are getting unlimited amount of NewsLetter Subscription Emails
reference-> https://hackerone.com/thecyberjerry?type=user

Prevention
I suggest you enable CAPTCHA on frontend and admin for every feature to help prevent these kinds of reports. 
Although in this case there is no Captcha for newsletter subscription.. 
But you can enable requiring email confirmation. Please go through config and enable every paranoid option you can find. :)
Impact 
An Attacker Can Send Bulk Emails and Many Emails and in Emails He can inject Infected XSS which can captures USER SESSION TOKEN

Sure,Just having an Idea about If an attacker can manipulate the flow of Email Subscription he also can inject XSS or any other infected code which can hijack User Session.Don't Worry Just having a guess about XSS because i m working on it and scanning about any XSS bug. :)
When this BUG will be fixed that will automatically be fixed...
Cheers : )
- Try making multiple requests for subscription cancellation (race conditions) to see if you can get multiple refunds.

7. Cart/Wishlist Abuse 
- Add a product in negative quantity with other products in positive quantity to balance the amount.
- Add a product in more than the available quantity.
- Try to see when you add a product to your wishlist and move it to a cart if it is possible to move it to some other user's cart or delete it from there.

8. Thread Comment Functionality
- Unlimited Comments on a thread
- Suppose a user can comment only once, try race conditions here to see if multiple comments are possible.
- Suppose there is an option: comment by the verified user (or some privileged user) try to tamper with various parameters in order to see if you can do this activity.
- Try posting comments impersonating some other users.
(Cont'd...)
9. Parameter Tampering 
- Tamper Payment or Critical Fields to manipulate their values
- Add multiple fields or unexpected fields by abusing HTTP Parameter Pollution & Mass Assignment
- Response Manipulation to bypass certain restrictions such as 2FA Bypass 

10. App Implementation Logic Abuse
- If an app accepts JSON data, try changing content type to XML and see if the XML data is being processed, it can be left vulnerable to XXE or XML-based attacks.
- If an application is using the DELETE method to delete a resource but there is no CSRF protection, try converting the method to GET/POST and add an additional parameter like ?method=delete
- In the above case if any user ID is going in the request, try bypassing method-based restrictions by adding parameters like X-Method-Override.
- If you see a UUID, try to replace with similar mapping such as 1,2,3.. often UUID mapping is accepted by the applications.
- Try the HEAD method to bypass the authentication restrictions. 

11. Denial of Service Situations 
- Resource Exhaustion
- Weak Account Lockout Mechanisms
- Kicking out a user/banning a user somehow from accessing the application.
- Application Level DoS by abusing the various functionalities present within the application.

In a nutshell, business logic absuse is a special class of vulnerabilities that I personally feel has no end.
Every application might have some different or special logics which are unique to them and it's always fun to abuse them and circumvent their original workflow.

12. Account takeover due to misconfiguration
-Its a very simple logical flaw that results in this
- So suppose we are victim@gmail.com , now login into the website then
- go to account settings and then change mail address to victim111@gmail.com
- a link will be sent to victim111@gmail.com, now the user realizes that he have lost access to victim111@gmail.com due to some reasons
- so he will probably change mail to the another mail address for e.g victim999@gmail.com which he owns and has access to
- but it is found that even after verifying victim999@gmail.com, the old link which was sent to victim111@gmail.com is active, 
 so user/attacker having access to that mail can verify it and takeover acc
 
 In a nutshell :
- It is mandatory for a web app to invalidate the tokens in time to secure its user
- In this case, suppose while changing mail address the user mistakenly typed wrong mail address, so the link will be sent to that mail address.
- So the user probably don't want the user of that mail address to verify it, so he will quickly change his mail address to one he owns and verify it-
- what he doesn't know is that even after verification(change of major state), the old link is still active
- the flaw :
- user changes mail to attacker@gmail.com -> user realizes that he mistyped the mail -> so he again changes to mail he owns and verifies it 
- -> old link sent to attacker@gmail.com is still active even after new mail has been verified

